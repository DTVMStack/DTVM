(module
  (memory 1)
  (func (export "test1") (result i32)
    (drop (i32.load (i32.const 100000)))
    (i32.load (i32.const 0))
  )
  (func (export "test2") (result i32)
      (i32.load (i32.const -1))
    )
  (func (export "test3") (result i32)
      (i32.store (i32.const 10) (i32.const 123))
      (i32.store (i32.const 123) (i32.const 456))
      (i32.load (i32.load (i32.const 10)))
    )
  (func (export "test4") (result i32)
         (i32.load (i32.load (i32.const 1000)))
       )
  (func (export "test5") (result i32)
        (i32.store (i32.const 3000) (i32.const -1))
        (i32.load (i32.load (i32.const 3000)))
      )
  (func (export "test6") (result i32)
       (drop (i32.load (i32.const -1)))
       (i32.load (i32.const 0))
      )

  (func (export "test11") (result i32)
      (i32.store (i32.const 100000) (i32.const 0))
      (i32.load (i32.const 0))
    )
  (func (export "test12") (result i32)
        (i32.store (i32.const -1) (i32.const 0))
        (i32.const 0)
      )
  (func (export "test13") (result i32)
        (i32.store (i32.const 10) (i32.const 123))
        (i32.store (i32.const 123) (i32.const 456))
        (i32.store (i32.load (i32.const 10)) (i32.const 7))
        (i32.load (i32.load (i32.const 10)))
      )
  (func (export "test14") (result i32)
           (i32.store (i32.load (i32.const 1000)) (i32.const 0))
           (i32.const 0)
         )
  (func (export "test15") (result i32)
           (i32.store (i32.const 3000) (i32.const -1))
           (i32.store (i32.load (i32.const 3000)) (i32.const 7))
          (i32.load (i32.load (i32.const 3000)))
         )
  (func (export "test16") (result i32)
         (i32.store (i32.const -1) (i32.const 7))
         (i32.load (i32.const 0))
        )

  (func (export "64_good5") (param $i i32) (result i64)
      (i64.load offset=25 align=8 (local.get $i))            ;; 122 'z\0\0\0\0\0\0\0'
    )

  (func (export "64_bad") (param $i i32)
      (drop (f64.load offset=4294967295 (local.get $i)))
    )

  (func (export "64_bad2") (param $i i32)
                    (drop (f64.load offset=2147483648 (local.get $i)))
                  )

  (data (i32.const 0) "a")
  (data (i32.const 1000) "ffffffff")
)

(assert_trap (invoke "test1") "out of bounds memory access")
(assert_trap (invoke "test2") "out of bounds memory access")
(assert_return (invoke "test3") (i32.const 456))
(assert_trap (invoke "test4") "out of bounds memory access")
(assert_trap (invoke "test5") "out of bounds memory access")
(assert_trap (invoke "test6") "out of bounds memory access")
(assert_trap (invoke "test11") "out of bounds memory access")
(assert_trap (invoke "test12") "out of bounds memory access")
(assert_return (invoke "test13") (i32.const 7))
(assert_trap (invoke "test14") "out of bounds memory access")
(assert_trap (invoke "test15") "out of bounds memory access")
(assert_trap (invoke "test16") "out of bounds memory access")

(assert_trap (invoke "64_good5" (i32.const 65504)) "out of bounds memory access")
(assert_trap (invoke "64_bad" (i32.const 0)) "out of bounds memory access")
(assert_trap (invoke "64_bad" (i32.const 1)) "out of bounds memory access")
(assert_trap (invoke "64_bad2" (i32.const 0)) "out of bounds memory access")
